# avito-requests

Подробное описание действий внутри самого Jupiter notebook

## О модели

**RuBERT-CRF Space Restoration** — это гибридная модель, объединяющая преимущества предобученного трансформера RuRoBERTa и слоя условных случайных полей (CRF) для точного и согласованного восстановления пропущенных пробелов в русском тексте. Такой подход позволяет:

- Использовать глубокие контекстные представления символов от RuRoBERTa для учёта сложной морфологии и контекста.
- Моделировать зависимость между соседними позициями пробелов через CRF, что обеспечивает согласованность предсказаний.


## Почему выбран именно этот метод

1. **RuRoBERTa-large** демонстрирует высокую точность на задачах русского языка благодаря обширному обучению на больших корпусах.
2. **CRF-слой** помогает устранить «шумиху» непоследовательных предсказаний, гарантируя, что восстановление пробелов происходит в выверенном порядке.

## Датасет

Для обучения использовался балансированный CSV с отзывами на женскую одежду и аксессуары:
https://github.com/sismetanin/rureviews/blob/master/women-clothing-accessories.3-class.balanced.csv

### Предобработка

1. Загрузка текстов из колонки `review` в DataFrame.
2. Фильтрация предложений длиной 3–20 слов.
3. Создание **синтетических** обучающих примеров:
    - Удаление пробелов из текста:

```
"куплю джинсы Levi’s" → "куплюджинсыLevi’s"
```

    - Вычисление списка индексов позиций, где раньше были пробелы.
4. Формирование списка примеров `(text_no_spaces, space_positions)`.

## Обработка данных

- Тексты без пробелов и соответствующие списки позиций передаются в `SpaceRestorationDataset`.
- На этапе токенизации используется `AutoTokenizer` с `add_prefix_space=True`, чтобы корректно выровнять сабтокены.
- С помощью `offset_mapping` символные метки переводятся в метки на уровне токенов (0/1).


